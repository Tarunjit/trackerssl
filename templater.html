<script src="app/bower_components/handlebars/handlebars.min.js"></script>
<script id="hello-world-template" type="text/x-handlebars-template">
    {{#if ssl}}
    	<h1 id="leadMessage">This website was served through SSL!</h1>
    	{{#if uniqueHosts}}
	    	<p id="trackerCount"><strong>{{percentageSSL}}%</strong> of the {{uniqueHostsTotal}} third party trackers on this page support SSL.</p>
	    	{{#if completeTrackersSSL}}
	    		<p>Given {{hostName}} only uses SSL-supporting trackers, why don&lsquo;t you tweet your thanks to them?</p>
          <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Thank%20you%20{{hostName}}%20for%20supporting%20SSL%20and%20doing%20your%20part%20to%20fight%20mass%20surveillance!%20%23trackerSSL" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
	    	{{else}}
	    		<p>Since some of these trackers aren&lsquo;t secure, <strong>why don&lsquo;t you tell {{hostName}} to ensure its trackers support SSL?</strong></p>
          <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Thank%20you%20{{hostName}}%20for%20supporting%20SSL%2C%20but%20since%20some%20of%20your%20trackers%20don%27t%2C%20it%20breaks%20your%20security!%20Might%20wanna%20fix%20that.%20%23trackerSSL" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
	    	{{/if}}
	    {{else}}
	    	<p id="trackerCount">No 3rd party trackers on this site.</p>
	    	<p>Why don&lsquo;t you thank {{hostName}} for supporting SSL?</p>
        <div id="widget">
          <div class="btn-o" data-scribe="component:button">
            <a href="https://twitter.com/intent/tweet?text=Thank%20you%20{{hostName}}%20for%20supporting%20SSL%20and%20doing%20your%20part%20to%20fight%20mass%20surveillance!%20%23trackerSSL" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
          </div>
        </div>
	    {{/if}}
    {{else}}
    	{{#if couldBeSSL}}
    		<h1 id="leadMessage">This website supports SSL but it&lsquo;s not the default!</h1>
    		{{#if uniqueHosts}}
		    	<p id="trackerCount"><strong>{{percentageSSL}}%</strong> of the {{uniqueHostsTotal}} third party trackers on this page could support SSL.</p>
		    	{{#if majorityTrackersSSL}}
		    		<p>Since a majority of these trackers are secure, <strong>why don&lsquo;t you tell {{hostName}} to make SSL the default?</strong></p>
            <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Hey%20{{hostName}}%20Why%20don't%20you%20do%20your%20part%20in%20the%20fight%20against%20mass%20surveillance%20and%20enable%20HTTPS%20by%20default%3F%20%23trackerssl" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
		    	{{else}}
		    		<p>Since many of these trackers aren&lsquo;t secure, <strong>why don&lsquo;t you tell {{hostName}} to use more responsible ad networks?</strong></p>
            <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Hey%20{{hostName}},%20most%20of%20your%20ad%20trackers%20don't%20support%20SSL.%20Consider%20some%20that%20do!%20Do%20your%20part%20in%20fighting%20mass%20surveillance.%20%23trackerSSL" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
		    	{{/if}}
		    {{else}}
		    	<p id="trackerCount">No 3rd party trackers on this site.</p>
		    	<p>Since there are no third party dependencies preventing it, why don&lsquo;t you ask {{hostName}} to adopt SSL by default?</p>
          <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Hey%20{{hostName}}%20Why%20don't%20you%20do%20your%20part%20in%20the%20fight%20against%20mass%20surveillance%20and%20enable%20HTTPS%20by%20default%3F%20%23trackerssl" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
		    {{/if}}
    	{{else}}
    		<h1 id="leadMessage">This website is insecure.</h1>
			{{#if uniqueHosts}}
		    	<p id="trackerCount"><strong>{{percentageSSL}}%</strong> of the {{uniqueHostsTotal}} third party trackers on this page could support SSL.</p>
		    	{{#if majorityTrackersSSL}}
		    		<p>Since a majority of these trackers are secure, <strong>why don&lsquo;t you tell {{hostName}} to support SSL too?</strong></p>
            <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Hey%20{{hostName}},%20most%20of%20your%20ad%20trackers%20support%20SSL.%20Why%20don't%20you%3F%20Do%20your%20part%20to%20fight%20mass%20surveillance.%20%23trackerSSL" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
		    	{{else}}
		    		<p>Since many of these trackers aren&lsquo;t secure, <strong>why don&lsquo;t you tell  {{hostName}} to use more responsible ad networks?</strong></p>
            <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Hey%20{{hostName}},%20most%20of%20your%20ad%20trackers%20don't%20support%20SSL.%20Consider%20some%20that%20do!%20Do%20your%20part%20in%20fighting%20mass%20surveillance.%20%23trackerSSL" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
		    	{{/if}}
		    {{else}}
		    	<p id="trackerCount">No 3rd party trackers on this site.</p>
		    	<p>Since there are no third party dependencies preventing it, why don&lsquo;t you ask {{hostName}} to adopt SSL?</p>
          <div id="widget">
            <div class="btn-o" data-scribe="component:button">
              <a href="https://twitter.com/intent/tweet?text=Hey%20{{hostName}}%20Why%20don't%20you%20do%20your%20part%20in%20the%20fight%20against%20mass%20surveillance%20and%20enable%20HTTPS%20by%20default%3F%20%23trackerssl" target="_blank" class="btn" id="b"><i></i><span class="label" id="l">Tweet</span></a>
            </div>
          </div>
		    {{/if}}
    	{{/if}}
    {{/if}}
    {{#if identifiers}}
      {{#if ssl}}
        <h2 class="good"><i class="fa fa-user"></i> Secure Identifiers</h2>
        <div class="hostsContainer">
        <ul id="badHosts">
        {{#each identifiers}}
            {{#if supportsSSL}}
            <li>
              <span class="unique_key"><i class="fa fa-search"></i> {{this.unique_key}}</span>
              <i class="fa fa-unlock"></i> {{this.hostname}} <span class="identifier">{{this.key_name}}</span>
            </li>
            {{/if}}
        {{/each}}
        {{#each identifiers}}
            {{#if supportsSSL}}
              <!-- -->
            {{else}}
            <li>
              <span class="unique_key"><i class="fa fa-search"></i> {{this.unique_key}}</span>
              <i class="fa fa-eye"></i> {{this.hostname}} <span class="identifier">{{this.key_name}}</span>
            </li>
            {{/if}}
        {{/each}}
        </ul>
        </div>
      {{else}}
        <h2 class="bad"><i class="fa fa-user"></i> Insecure Identifiers</h2>
        <p>Unique IDs about your web browsing habits have been <strong>insecurely sent</strong> to third parties.</p>
        <div class="hostsContainer">
        <ul id="badHosts">
        {{#each identifiers}}
            {{#if supportsSSL}}
            <li>
              <span class="unique_key"><i class="fa fa-search"></i> {{this.unique_key}}</span>
              <i class="fa fa-unlock"></i> {{this.hostname}} <span class="identifier">{{this.key_name}}</span>
            </li>
            {{/if}}
        {{/each}}
        {{#each identifiers}}
            {{#if supportsSSL}}
              <!-- -->
            {{else}}
            <li>
              <span class="unique_key"><i class="fa fa-search"></i> {{this.unique_key}}</span>
              <i class="fa fa-eye"></i> {{this.hostname}} <span class="identifier">{{this.key_name}}</span>
            </li>
            {{/if}}
        {{/each}}
        </ul>
        </div>
              <p class="small">Trackers marked with <i class="fa fa-unlock"></i> could send these IDs safely if {{hostName}} itself was secure.</p>
        <p class="small">Those marked <i class="fa fa-eye"></i> do not support secure transmission.</p>
      {{/if}}
    {{/if}}
</script>
<script>
  var templates = [];
  var source = document.getElementById('hello-world-template').innerHTML;
  templates['hello'] = Handlebars.compile(source);
</script>
<script>
  window.addEventListener('message', function(event) {
    var command = event.data.command;
    var name = event.data.name || 'hello';
    switch(command) {
      case 'render':
        event.source.postMessage({
          name: name,
          html: templates[name](event.data.context)
        }, event.origin);
       break;
    }
  });
</script>